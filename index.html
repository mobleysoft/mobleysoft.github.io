<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobleysoft Quantum OS</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://mobleysoft.com/1Holder/Assets/Scripts/Blackhole.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: black; font-family: "Inter", sans-serif; color: white; cursor: url('https://mobleysoft.com/cursor.glow.cur'), auto; }
        #site-directory {
            position: fixed;
            bottom: 50px;
            left: 10px;
            width: 300px;
            max-height: 400px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #ffcc00;
            box-shadow: 0px 0px 15px rgba(255, 204, 0, 0.8);
            font-family: "Inter", sans-serif;
            padding: 10px;
            display: none;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease-in-out;
        }
        .directory-item {
            cursor: pointer;
            color: #ffcc00;
            padding: 5px;
            background: rgba(30, 30, 30, 0.9);
            border: 1px solid #ffcc00;
            margin-bottom: 2px;
            transition: transform 0.2s, background 0.2s;
        }
        .directory-item:hover {
            background: rgba(50, 50, 50, 0.9);
            transform: scale(1.05);
        }
        #file-overlay {
            display: none;
            position: fixed;
            top: 10%;
            left: 50%;
            transform: translateX(-50%) scale(0.9);
            width: 80%;
            height: 70%;
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 10px;
            border: 2px solid #ffcc00;
            box-shadow: 0px 0px 20px rgba(255, 204, 0, 0.9);
            overflow: auto;
            backdrop-filter: blur(10px);
            animation: popIn 0.3s ease-in-out forwards;
        }
        #file-content {
            width: 100%;
            height: 90%;
            background: black;
            padding: 10px;
            border: 1px solid #ffcc00;
            overflow: auto;
            color: #ffcc00;
        }
        #close-overlay {
            position: absolute;
            top: 5px;
            right: 5px;
            cursor: pointer;
            color: #ffcc00;
            font-size: 16px;
            font-weight: bold;
            background: black;
            padding: 2px 5px;
            border: 1px solid #ffcc00;
            transition: transform 0.2s;
        }
        #close-overlay:hover {
            transform: scale(1.2);
        }
        #logo {
            position: fixed;
            bottom: 10px;
            left: 10px;
            cursor: pointer;
            transition: transform 0.3s ease-in-out;
        }
        #logo:hover {
            transform: scale(1.1) rotate(3deg);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes popIn {
            from { opacity: 0; transform: translateX(-50%) scale(0.7); }
            to { opacity: 1; transform: translateX(-50%) scale(1); }
        }
    </style>
</head>
<body>
    <canvas id="blackhole"></canvas>
    <img id="logo" src="https://jmobleyworks.github.io/Assets/Images/MobleysoftGothicLogoBarWithM.png" alt="Mobleysoft" height="50px" onclick="toggleDirectory()">
    <div id="site-directory">Loading site directory...</div>
    <div id="file-overlay">
        <span id="close-overlay" onclick="closeOverlay()">âœ–</span>
        <div id="file-content"></div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", async () => {
            await initializeBlackholeBackground();
            await loadSiteDirectory();
            autoAnimateWindows();
        });

        async function initializeBlackholeBackground() {
            console.log("Three.js Loaded");
            createBlackhole();
        }

        function createBlackhole() {
            // Blackhole.js effect initialized here
        }

        async function loadSiteDirectory() {
            try {
                const response = await fetch("https://mobleysoft.com/site-directory.json");
                const directory = await response.json();
                displayRootDirectory(directory);
            } catch (error) {
                console.error("Failed to load site directory:", error);
            }
        }

        function displayRootDirectory(directory) {
            const rootContainer = document.getElementById("site-directory");
            rootContainer.innerHTML = "";
            Object.entries(directory).forEach(([name, type]) => {
                const item = document.createElement("div");
                item.className = `directory-item ${type}`;
                item.textContent = name;
                item.onclick = () => handleItemClick(name, type);
                rootContainer.appendChild(item);
            });
        }

        function handleItemClick(name, type) {
            if (type === "folder") {
                openFolder(name);
            } else {
                openFile(name, type);
            }
        }

        function openFolder(folderName) {
            console.log("Opening folder:", folderName);
            const overlay = document.getElementById("file-overlay");
            overlay.style.display = "block";
            const content = document.getElementById("file-content");
            content.innerHTML = `<h3>${folderName}</h3><p>Folder contents will be displayed here.</p>`;
        }

        function openFile(fileName, type) {
            console.log("Opening file:", fileName);
            const overlay = document.getElementById("file-overlay");
            overlay.style.display = "block";
            const content = document.getElementById("file-content");
            content.innerHTML = `<iframe src="${fileName}" width="100%" height="100%"></iframe>`;
        }

        function closeOverlay() {
            document.getElementById("file-overlay").style.display = "none";
        }
    </script>
</body>
</html>
