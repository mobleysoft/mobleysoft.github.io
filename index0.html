<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobleysoft - AI Consulting SaaS</title>
    <script async src="https://js.stripe.com/v3/pricing-table.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #000;
            font-family: Arial, sans-serif;
            color: white;
        }

        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        #shrinkWrap {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 10;
            transition: opacity 1.5s ease-in-out, transform 0.5s;
            opacity: 0.0;
            pointer-events: auto;
            /* No interaction blocking */
            width: auto;
            /* Adjust dynamically */
            height: auto;
            /* Let JavaScript control final fit */
            max-width: 100vw;
            /* Prevent horizontal overflow */
            max-height: 100vh;
            /* Prevent vertical overflow */
            padding: 1px;
        }

        #shrinkWrap.visible {
            opacity: 0.9 !important;
            pointer-events: auto !important;
        }

        #overlay {
            display: flex;
            flex-direction: column;
            gap: 0px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 10;
            transition: opacity 1.5s ease-in-out;
            opacity: 1.0;
            pointer-events: auto;
        }

        .visible {
            opacity: .9;
            pointer-events: auto;
        }

        stripe-pricing-table {
            flex: 1;
            max-width: 1000px;
            min-width: 250px;
            padding: 0px;
            background: transparent !important;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        stripe-pricing-table:hover {
            background: transparent !important;
            /* Make background transparent */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            transform: scale(1.00);
            /* Slight zoom effect */
            transition: 0.0s ease-in-out;
        }

        header {
            background-color: #000000;
            color: #fdfdf3;
            text-align: center;
            border-bottom: 2px solid #fdfdf3;
        }

        .footer-bar {
            display: flex;
            justify-content: center;
            align-items: center;
            background: #000;
            padding: 0px;
            font-size: 14px;
        }

        .footer-logo {
            font-weight: bold;
            font-size: 16px;
            color: #ffcc00;
            margin-right: 10px;
        }

        .footer-link {
            text-decoration: none;
            padding: 3px 8px;
            color: #ffcc00;
            border: 1px solid #ffcc00;
            font-weight: normal;
            background: none;
        }

        .footer-link.devtoolbx {
            background-color: #ffcc00;
            color: #000;
            font-weight: bold;
        }

        .footer-separator {
            padding: 0 5px;
            color: #ffcc00;
        }

        #wireframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 2px solid #ffcc00;
            box-shadow: 0 0 10px #ffcc00;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s, transform 0.5s;
        }

        #subapp-container {
            position: absolute;
            /* Instead of fixed */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: black;
            padding: 1px;
            color: white;
            text-align: left;
            display: none;
            border: 1px solid #ffcc00;
            box-shadow: 0 0 3px #ffcc00;
            opacity: .9;
            font-size: 12px;
        }


        #closeSubApp {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            color: #ffcc00;
            border: none;
            font-size: 20px;
            cursor: pointer;
        }

        .startup-footer {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 4px;
            flex-flow: row wrap;
            justify-content: normal;
            align-items: center;
            background: #000;
            padding: 2px;
            font-size: 14px;
            flex-wrap: wrap;
            border: none;
        }

        .startup-link {
            flex-grow: 1;
            text-decoration: none;
            padding: 0px 0px;
            color: #ffcc00;
            font-weight: normal;
            background: none;
            cursor: pointer;
            margin: 2px;
            white-space: nowrap;
            border: none;
        }

        .startup-link.MobCorp {
            background-color: #ffcc00;
            color: #000;
            font-weight: bold;
            border: none;
        }
    </style>
</head>

<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://mobleysoft.com/1Holder/Assets/Scripts/Blackhole.js"></script>
    <canvas id="blackhole"></canvas>
    <div>
        <div id="subapp-container"><button id="closeSubApp" onclick="closeSubApp()">✖</button></div>
        <div id="overlay" style="width:1000px!important">
            <div id="shrinkWrap">
                <div id="wireframe"></div>
                <div id="app">
                    <div id="logoRow">
                        <div id="logo">
                            <header>
                                <div><img
                                        src="https://jmobleyworks.github.io/Assets/Images/MobleysoftGothicLogoBarWithM.png"
                                        alt="Mobleysoft" height="100px"></div>
                            </header>
                        </div>
                    </div>
                    <div id="pricingTableRow"><stripe-pricing-table pricing-table-id="prctbl_1QSMCtLWTxUJi5AVAc7zahno"
                            publishable-key="pk_live_51QSK8LLWTxUJi5AV3h9n8yTt8upsRRZVDWKKLRy8XLQEGosWsRCIpqxolyN3cii4EliBIQML39fEcdCEdQQg5sov00nxpPW5WG"></stripe-pricing-table>
                    </div>
                </div>
                <div class="footer-bar">
                    <span class="footer-logo">MobleysoftAGI</span>
                    <a href="#" class="footer-link devtoolbx" onclick="activateTool('DevToolBx')">DevToolBx</a>
                    <a href="#" class="footer-link" onclick="activateTool('DevToolAI')">DevToolAI</a>
                    <a href="#" class="footer-link" onclick="activateTool('HalsIDE')">HalsIDE</a>
                    <a href="#" class="footer-link" onclick="activateTool('DevDucky')">DevDucky</a>
                    <a href="#" class="footer-link" onclick="activateTool('Fystz')">Fystz</a>
                    <a href="#" class="footer-link" onclick="activateTool('Extraterran')">Extraterran</a>
                    <a href="#" class="footer-link" onclick="activateTool('HelmDir')">HelmDir</a>
                    <a href="#" class="footer-link" onclick="activateTool('ToolMaker20')">ToolMaker20</a>
                    <a href="#" class="footer-link" onclick="activateTool('FirmSmith200')">FirmSmith200</a>
                    <a href="#" class="footer-link" onclick="activateTool('IndustryPress2k')">IndustryPress2k</a>
                </div>
                <div class="startup-footer" id="startup-toolbar"><span class="startup-link MobCorp">MobCorp</span></div>
            </div>
        </div>
    </div>
    <script>
        async function loadStartups() {
            try {
                const response = await fetch('https://mobleysoft.com/1Holder/Webware/Startups/');
                const text = await response.text();
                const startupList = text.split(',').map(item => item.trim());
                const toolbar = document.getElementById('startup-toolbar');
                startupList.forEach(startup => {
                    if (!startup.includes("HTML")) {  // Corrected 'contians' to 'includes'
                        const button = document.createElement('a');
                        button.className = 'startup-link';
                        button.textContent = startup;
                        button.onclick = () => activateTool(startup);
                        toolbar.appendChild(button);
                    }
                });
            } catch (error) {
                console.error('Error loading startups:', error);
            }
        }
        document.addEventListener('DOMContentLoaded', loadStartups);
        function activateTool(toolName) {
            const wireframe = document.getElementById('wireframe');
            let subappContainer = document.getElementById('subapp-container');

            // Ensure subapp-container is inside the correct parent
            const parentContainer = document.getElementById('shrinkWrap'); // Or change to a more appropriate element
            if (!parentContainer.contains(subappContainer)) {
                parentContainer.appendChild(subappContainer);
            }

            wireframe.style.opacity = 1;
            wireframe.style.transform = 'scale(1.37)';

            setTimeout(() => {
                wireframe.style.opacity = 0;
                wireframe.style.transform = 'scale(1)';
                subappContainer.style.display = 'block';
                subappContainer.innerHTML = `<button id="closeSubApp" onclick="closeSubApp()">✖</button><h2>${toolName}</h2><p>Now running ${toolName}.</p>`;
            }, 500);
        }

        function closeSubApp() {
            document.getElementById('subapp-container').style.display = 'none';
        }

        document.addEventListener("DOMContentLoaded", () => {
            setTimeout(showOverlay, 500);
        });

        const shrinkWrap = document.getElementById("shrinkWrap");
        let idleTimer;

        function showOverlay() {
            shrinkWrap.classList.add("visible");
            resetIdleTimer();
        }

        function hideOverlay() {
            shrinkWrap.style.opacity = "0"; // Smooth fade-out
            setTimeout(() => {
                shrinkWrap.classList.remove("visible"); // Fully hide after transition
            }, 1500);
        }

        function resetIdleTimer() {
            clearTimeout(idleTimer);
            idleTimer = setTimeout(hideOverlay, 6000);
        }

        // Improve event responsiveness
        document.addEventListener("mousemove", showOverlay);
        document.addEventListener("click", showOverlay);
        document.addEventListener("keydown", showOverlay);
        document.addEventListener("touchstart", showOverlay);
        document.addEventListener("keydown", (event) => { if (event.key === "Escape") closeSubApp(); });

        function adjustShrinkWrapScale() {
            const shrinkWrap = document.getElementById("shrinkWrap");
            if (!shrinkWrap) return;

            const viewportHeight = window.innerHeight;
            const contentHeight = shrinkWrap.scrollHeight;
            // Compute scale factor based on height ratio
            let scaleFactor = viewportHeight / contentHeight;
            // Ensure we don't scale larger than 1:1
            if (scaleFactor > 1) scaleFactor = 1;
            // Apply a slight buffer (e.g., 90% of max scale) to avoid over-expansion
            scaleFactor *= 0.83;
            // Apply dynamic scaling
            shrinkWrap.style.transform = `translate(-50%, -50%) scale(${scaleFactor})`;
            shrinkWrap.style.opacity = "0.9"; // Keep visibility
            shrinkWrap.style.pointerEvents = "auto"; // Ensure buttons remain clickable
        }
        // Apply scaling after DOM loads and on resize
        window.addEventListener("load", adjustShrinkWrapScale);
        window.addEventListener("resize", adjustShrinkWrapScale);
    </script>
</body>

</html>