function GenerateRandomNoiseWaveform {param ([int]$DurationSeconds) $sampleRate = 44100; $samples = New-Object 'System.Collections.Generic.List[Single]'; for ($i = 0; $i -lt ($sampleRate * $DurationSeconds); $i++) {$samples.Add((Get-Random -Minimum -1.0 -Maximum 1.0))} return $samples.ToArray()}
function SaveAsWav {param ([string]$OutputFilePath, [single[]]$Samples) $wavFile = New-Object System.IO.FileStream($OutputFilePath, [System.IO.FileMode]::Create); $writer = New-Object System.IO.BinaryWriter($wavFile); $writer.Write([Text.Encoding]::ASCII.GetBytes("RIFF")); $writer.Write([int](36 + $Samples.Length * 2)); $writer.Write([Text.Encoding]::ASCII.GetBytes("WAVEfmt ")); $writer.Write([int]16); $writer.Write([int16]1); $writer.Write([short]1); $writer.Write([int]44100); $writer.Write([int](44100 * 2)); $writer.Write([short]2); $writer.Write([short]16); $writer.Write([Text.Encoding]::ASCII.GetBytes("data")); $writer.Write([int]($Samples.Length * 2)); foreach ($sample in $Samples) {$writer.Write([short]([math]::Round($sample * 32767)))} $writer.Close(); $wavFile.Close(); Write-Host "WAV file saved to $OutputFilePath"}
function TestRandomNoiseGeneration {Write-Host "Generating random noise..."; $compressedPath = "random_noise.wav"; $samples = GenerateRandomNoiseWaveform -DurationSeconds 3; Write-Host "Saving WAV file..."; SaveAsWav -OutputFilePath $compressedPath -Samples $samples; Write-Host "Random noise WAV file saved to $compressedPath"}
TestRandomNoiseGeneration
